
<template class="productlistTemplate">
   <div class="productlist">
        <article class="col-span-2 md:col-span-3">
            <div class="productImg">
                <a href="/productview/?id=">
                <img class="mainImage" src="" alt="product">
                </a>
            </div>
            <div class="infobox">
                <h5 class="accentBody name">AGAB Skirt</h5>
                <p class="overlinep">From <span class="price">1000</span> dkk</p>
            </div>
        </article>
   </div>
</template>

<script is:inline>

// window.addEventListener("DOMContentLoaded", init);
window.addEventListener("DOMContentLoaded", init);

function init(event) {

const url = "https://evelinafalander.com/sallybjerregaarde/wp-json/wp/v2/garment";

fetch(url)
.then(function(res){
  return res.json();
})
.then(function(data){
  handleProductList(data);
});

function handleProductList(data){
  console.log(data)
  data.forEach(showProduct);
}
}

function showProduct(garment){
  console.log(garment);
  const template = document.querySelector(".productlistTemplate").content;
  const copy = template.cloneNode(true);
  //change content
  copy.querySelector(".price").textContent = `${garment.price_3days}`;
  copy.querySelector(".name").textContent = `${garment.title.rendered}`;
  copy
      .querySelector("a")
      .setAttribute("href", `/singlegarment/?id=${garment.id}`);
  copy.querySelector(".mainImage").src = garment.main_image.guid;

  const parent = document.querySelector(".garmentlist");
  parent.appendChild(copy);
}


// NOT IN USE


// function init(event) {
//   let params = new URLSearchParams(document.location.search);
//   let id = params.get("id");
//   let url = "https://evelinafalander.com/sallybjerregaarde/wp-json/wp/v2/garment";

//   if (id) {
//     url += `/${id}`;
//   }

//   getData(url + "?_embed");

//   async function getData(fetchurl) {
//     console.log(fetchurl);
//     let result = await fetch(fetchurl);
//     if (id) {
//       showSingleGarment(await result.json());
//     } else {
//       showGarments(await result.json());
//     }
//   }
// }

// function showGarments(productArray) {
//   console.log(productArray);
//   const template = document.querySelector(".productlistTemplate").content;
//   const parentElement = document.querySelector(".productlist");
//   productArray.forEach((garment) => {
//     const copy = template.cloneNode(true);
//     copy.querySelector(".name").textContent = garment.title.rendered;
//     copy
//       .querySelector("a")
//       .setAttribute("href", `/productview/?id=${garment.id}`);
//     copy.querySelector(".price").textContent = garment.price;
//     copy.querySelector(".image").src =
//       garment.main_embedded[
//         "wp:featuredmedia"
//       ][0].media_details.sizes.medium_large.source_url;
//     parentElement.appendChild(copy);
//   });
// }
        </script>